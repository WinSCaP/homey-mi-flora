<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="node_modules/moment/moment.js"></script>
    <script>

        /**
         * @private
         *
         * @param document
         * @param deviceDisplay
         *
         * @return string
         *
         */
        function _generateHtml(document, deviceDisplay) {

            let borderColor = '';
            let color = '';
            let colorBackgroundColor = '#f7f5f5';
            let colorGreen = '#d3fec4';
            let borderColorGreen = '#b3e0a2';
            let colorRed = '#ffd3cb';
            let borderColorRed = '#dd958f';
            let borderColorDefault = '#e6e6e6';
            let textColor = '#9c9c9c';
            let borderTable = '#c6c6c6';
            let textColorSecondary = '#c7c7c7';

            let widthDefault = 200;
            let heightDefault = 25;

            let flowerTable = document;
            let td = document;
            let tr = document;
            let loader = document;
            let loaderTr = document;
            let loaderTd = document;
            let title = document;

            const target = document.createElement("div");
            target.style.fontFamily = 'sans-serif';

            flowerTable = document.createElement("table");
            flowerTable.cellPadding = 0;
            flowerTable.cellSpacing = 0;
            flowerTable.style.marginTop = '1em';
            flowerTable.style.marginBottom = '1em';

            tr = document.createElement("tr");
            td = document.createElement("td");
            td.style.height = heightDefault + "px";
            td.style.textAlign = 'center';
            td.colSpan = 5;
            title = document.createElement("span");
            title.style.fontFamily = 'sans-serif';
            title.style.fontSize = '1em';
            title.style.color = textColor;
            moment.locale('nl')
            let momentDate = moment(new Date(Date.parse(deviceDisplay.lastUpdate)));
            title.innerHTML = deviceDisplay.name + ' (' + momentDate.fromNow() + ')';
            td.appendChild(title);
            tr.appendChild(td);
            flowerTable.appendChild(tr);

            let trThreshold = document.createElement("tr");
            let tdThreshold = document;
            for (let i = 1; i <= 4; i++) {
                // threshold tr
                tdThreshold = document.createElement("td");
                tdThreshold.style.height = "6px";
                if (i === 2) {
                    tdThreshold.style.borderLeft = '1px solid ' + borderTable;
                }
                trThreshold.appendChild(tdThreshold);
            }

            for (const capabilityName in deviceDisplay.capabilities) {

                const capability = deviceDisplay.capabilities[capabilityName];

                const min = capability.min;
                const max = capability.max;
                let value = capability.value;

                const start = min - (max - min);
                const end = max + (max - min);

                const parts = [
                    {
                        min: start,
                        max: min
                    },
                    {
                        min: min,
                        max: max
                    },
                    {
                        min: max,
                        max: end
                    }
                ];

                color = colorRed;
                borderColor = borderColorRed;
                for (let i = 0; i < parts.length; i++) {
                    const part = parts[i];
                    if (part.min <= value && part.max >= value && i === 1) {
                        color = colorGreen;
                        borderColor = borderColorGreen;
                    }
                }
                let loaderDone = false;

                tr = document.createElement("tr");
                td = document.createElement("td");
                td.style.height = heightDefault + "px";
                td.colspan = 5;
                title = document.createElement("span");
                title.innerHTML = capability.sensor;
                title.style.margin = '0 5px 0 0';
                title.style.fontSize = '14px';
                title.style.fontFamily = 'sans-serif';
                title.style.color = textColor;
                td.appendChild(title);
                tr.appendChild(td);

                let trBuffer = document.createElement("tr");
                // add title
                let tdBuffer = document.createElement("td");
                trBuffer.appendChild(tdBuffer);

                for (let i = 0; i < parts.length; i++) {
                    const part = parts[i];

                    td = document.createElement("td");
                    td.style.whiteSpace = 'nowrap';
                    loader = document.createElement("table");
                    loader.cellPadding = 0;
                    loader.cellSpacing = 0;
                    loader.classList.add('loader');
                    loaderTr = document.createElement("tr");
                    loaderTd = document.createElement("td");
                    loaderTd.style.width = widthDefault + "px";
                    loaderTd.style.height = heightDefault + "px";

                    if (i === 0) {
                        td.style.borderLeft = '1px solid ' + borderTable;
                    }

                    loaderTd.style.backgroundColor = color;

                    // min = 125
                    // max = 175
                    // value = 150
                    // length = 175 - 125 = 50;
                    // offset - 175 - 150 = 25;
                    // percent = 100 / (50 / 25) = 50%
                    // width = 300 / 100 * 50 = 150px
                    let length = part.max - part.min;
                    let offset = part.max - value;
                    let percent = 100 / (length / offset);
                    loaderTd.style.textAlign = 'right';

                    title = document.createElement("span");
                    //title.innerHTML = value + Homey.__('capability.' + capability + '.suffix');
                    title.innerHTML = value + capability.suffix;
                    title.style.lineHeight = heightDefault + "px";
                    title.style.margin = '0 5px';
                    title.style.fontSize = '12px';
                    title.style.fontFamily = 'sans-serif';
                    title.style.color = textColor;

                    if (false === loaderDone) {
                        td.appendChild(loader);
                    }

                    // buffer tr
                    let tdBuffer = document.createElement("td");
                    tdBuffer.style.lineHeight = "15px";

                    let thresholdValue = document.createElement("span");
                    thresholdValue.style.lineHeight = "15px";
                    thresholdValue.style.margin = '0 3px';
                    thresholdValue.style.fontSize = '12px';
                    thresholdValue.style.fontFamily = 'sans-serif';

                    if (i === 0) {
                        tdBuffer.style.borderLeft = '1px solid ' + borderTable;
                    }
                    if (i === 0) {
                        tdBuffer.style.borderRight = '1px solid ' + borderColorDefault;
                        tdBuffer.style.textAlign = 'right';
                        thresholdValue.style.color = textColorSecondary;
                        thresholdValue.innerHTML = capability.min + capability.suffix;
                    }
                    if (i === 1) {
                        tdBuffer.style.borderRight = '1px solid ' + borderColorDefault;
                    }
                    if (i === 2) {
                        thresholdValue.style.color = textColorSecondary;
                        thresholdValue.innerHTML = capability.max + capability.suffix;
                        tdBuffer.style.textAlign = 'left';
                    }

                    tdBuffer.appendChild(thresholdValue);
                    trBuffer.appendChild(tdBuffer);

                    if (value <= part.min && i === 0) {
                        loaderTd.style.width = 0 + "px";
                        loaderTd.appendChild(title);
                        loaderTd.style.borderRight = '1px solid ' + borderColor;
                        loaderDone = true;
                    }
                    else if (part.min < value && part.max >= value) {
                        loaderTd.style.width = widthDefault - (widthDefault / 100 * percent) - 1 + "px";
                        loaderTd.appendChild(title);
                        loaderTd.style.borderRight = '1px solid ' + borderColor;
                        loaderDone = true;
                    }
                    else if (value > part.max && i === 2) {
                        loaderTd.style.width = widthDefault + "px";
                        loaderTd.appendChild(title);
                        loaderTd.style.borderRight = '1px solid ' + borderColor;
                        loaderDone = true;
                    }
                    loaderTr.appendChild(loaderTd);
                    loader.appendChild(loaderTr);

                    // min / max threshold
                    td.style.backgroundColor = colorBackgroundColor;
                    td.style.width = widthDefault + "px";
                    td.style.height = heightDefault + "px";
                    if (i !== 2) {
                        td.style.width = widthDefault - 1 + "px";
                        td.style.borderRight = '1px solid ' + borderColorDefault;
                    }
                    tr.appendChild(td);
                }

                flowerTable.appendChild(trThreshold.cloneNode(true));
                flowerTable.appendChild(trBuffer);
                flowerTable.appendChild(tr);
            }

            flowerTable.appendChild(trThreshold.cloneNode(true));

            tr = document.createElement("tr");
            td = document.createElement("td");
            tr.appendChild(td);
            td = document.createElement("td");
            td.style.borderBottom = '1px solid ' + borderTable;
            td.colSpan = 4;
            tr.appendChild(td);
            flowerTable.appendChild(tr);

            target.appendChild(flowerTable);
            target.style.backgroundColor = '#fbfbfb';

            return target.innerHTML;
        }

        function _generateFloraHtml(floraDevice) {

            let html = '';

            html += "<h3>" + floraDevice.name + "</h3>";

            return html;
        }

        // self executing function here
        document.addEventListener("DOMContentLoaded", function (event) {

            const devicesJson = '[{"__athom_api_type":"HomeyAPI.ManagerDevices.Device","id":"887bdab1-7565-48fc-8737-c200bc7b18bb","name":"Pilea glauca","zone":{"id":"5204dc44-8e9c-49e7-aed8-9d5c93330126","name":"Tuin","icon":"garden","index":4,"parent":"9919ee1e-ffbc-480b-bc4b-77fb047e9e68"},"data":{"id":"c47c8d660b51","uuid":"c47c8d660b51","address":"c47c8d660b51","version":"v2.0.11"},"icon":"/app/com.mi.flora/drivers/flora/assets/icon.svg","settings":{"firmware_version":"3.1.8","last_updated":"2018-11-13T09:44:06.870Z","measure_temperature_min":10,"measure_temperature_max":32,"measure_luminance_min":1000,"measure_luminance_max":3400,"flora_measure_fertility_min":350,"flora_measure_fertility_max":1000,"flora_measure_moisture_min":15,"flora_measure_moisture_max":30,"uuid":"c47c8d660b51"},"class":"sensor","capabilities":["measure_temperature","measure_luminance","flora_measure_fertility","flora_measure_moisture","measure_battery"],"flags":[],"mobile":{"components":[{"id":"icon"},{"id":"battery","capabilities":["measure_battery"]},{"id":"sensor","capabilities":["measure_temperature","measure_luminance","flora_measure_fertility","flora_measure_moisture"],"options":{"icons":{"measure_temperature":"/assets/temperature.svg","measure_luminance":"/assets/luminance.svg","flora_measure_fertility":"/assets/nutritions.svg","flora_measure_moisture":"/assets/moisture.svg"}}}]},"order":29,"online":true,"available":true,"capabilitiesObj":{"measure_temperature":{"uri":"homey:manager:devices","id":"measure_temperature","type":"number","desc":{"en":"Temperature","nl":"Temperatuur"},"title":{"en":"Temperature","nl":"Temperatuur"},"units":{"en":"°C"},"decimals":2,"chartType":"spline","getable":true,"setable":false,"value":17.3,"lastUpdated":"2018-11-13T09:44:06.681Z","options":{}},"measure_luminance":{"uri":"homey:manager:devices","id":"measure_luminance","type":"number","title":{"en":"Luminance","nl":"Helderheid"},"units":{"en":"lx"},"desc":{"en":"Luminance in Lux (lx)","nl":"Helderheid in Lux (lx)"},"chartType":"spline","decimals":2,"getable":true,"setable":false,"value":1670,"lastUpdated":"2018-11-13T09:44:06.684Z","options":{}},"flora_measure_fertility":{"uri":"homey:app:com.mi.flora","id":"flora_measure_fertility","type":"number","title":{"en":"Conductivity","nl":"Geleidingsvermogen"},"getable":true,"setable":false,"units":{"en":"µS/cm","nl":"µS/cm"},"min":0,"max":5000,"step":1,"value":4085,"lastUpdated":"2018-11-13T09:24:20.184Z","options":{}},"flora_measure_moisture":{"uri":"homey:app:com.mi.flora","id":"flora_measure_moisture","type":"number","title":{"en":"Moisture","nl":"Vochtigheid"},"getable":true,"setable":false,"units":{"en":"%","nl":"%"},"min":0,"max":100,"step":1,"value":54,"lastUpdated":"2018-11-13T09:44:06.755Z","options":{}},"measure_battery":{"uri":"homey:manager:devices","id":"measure_battery","type":"number","title":{"en":"Battery","nl":"Accuniveau"},"units":{"en":"%"},"min":0,"max":100,"desc":{"en":"Battery charge in percentage (%)","nl":"Accuniveau in procenten (%)"},"chartType":"spline","decimals":2,"getable":true,"setable":false,"value":99,"lastUpdated":"2018-11-13T09:44:06.876Z","options":{}}},"driverUri":"homey:app:com.mi.flora","driverId":"flora"},{"__athom_api_type":"HomeyAPI.ManagerDevices.Device","id":"d3c4f49b-4914-452e-8769-36ee7b7e7a5b","name":"Cactus","zone":{"id":"5204dc44-8e9c-49e7-aed8-9d5c93330126","name":"Tuin","icon":"garden","index":4,"parent":"9919ee1e-ffbc-480b-bc4b-77fb047e9e68"},"data":{"id":"c47c8d660875","uuid":"c47c8d660875","address":"c47c8d660875","version":"v2.0.11"},"icon":"/app/com.mi.flora/drivers/flora/assets/icon.svg","settings":{"firmware_version":"3.1.9","last_updated":"2018-11-13T09:44:16.004Z","measure_temperature_min":8,"measure_temperature_max":35,"measure_luminance_min":1000,"measure_luminance_max":5000,"flora_measure_fertility_min":350,"flora_measure_fertility_max":500,"flora_measure_moisture_min":10,"flora_measure_moisture_max":30,"uuid":"c47c8d660875"},"class":"sensor","capabilities":["measure_temperature","measure_luminance","flora_measure_fertility","flora_measure_moisture","measure_battery"],"flags":[],"mobile":{"components":[{"id":"icon"},{"id":"battery","capabilities":["measure_battery"]},{"id":"sensor","capabilities":["measure_temperature","measure_luminance","flora_measure_fertility","flora_measure_moisture"],"options":{"icons":{"measure_temperature":"/assets/temperature.svg","measure_luminance":"/assets/luminance.svg","flora_measure_fertility":"/assets/nutritions.svg","flora_measure_moisture":"/assets/moisture.svg"}}}]},"order":30,"online":true,"available":true,"capabilitiesObj":{"measure_temperature":{"uri":"homey:manager:devices","id":"measure_temperature","type":"number","desc":{"en":"Temperature","nl":"Temperatuur"},"title":{"en":"Temperature","nl":"Temperatuur"},"units":{"en":"°C"},"decimals":2,"chartType":"spline","getable":true,"setable":false,"value":17.5,"lastUpdated":"2018-11-13T09:44:15.783Z","options":{}},"measure_luminance":{"uri":"homey:manager:devices","id":"measure_luminance","type":"number","title":{"en":"Luminance","nl":"Helderheid"},"units":{"en":"lx"},"desc":{"en":"Luminance in Lux (lx)","nl":"Helderheid in Lux (lx)"},"chartType":"spline","decimals":2,"getable":true,"setable":false,"value":1565,"lastUpdated":"2018-11-13T09:44:15.798Z","options":{}},"flora_measure_fertility":{"uri":"homey:app:com.mi.flora","id":"flora_measure_fertility","type":"number","title":{"en":"Conductivity","nl":"Geleidingsvermogen"},"getable":true,"setable":false,"units":{"en":"µS/cm","nl":"µS/cm"},"min":0,"max":5000,"step":1,"value":2,"lastUpdated":"2018-11-13T09:44:15.834Z","options":{}},"flora_measure_moisture":{"uri":"homey:app:com.mi.flora","id":"flora_measure_moisture","type":"number","title":{"en":"Moisture","nl":"Vochtigheid"},"getable":true,"setable":false,"units":{"en":"%","nl":"%"},"min":0,"max":100,"step":1,"value":17,"lastUpdated":"2018-11-13T09:44:15.863Z","options":{}},"measure_battery":{"uri":"homey:manager:devices","id":"measure_battery","type":"number","title":{"en":"Battery","nl":"Accuniveau"},"units":{"en":"%"},"min":0,"max":100,"desc":{"en":"Battery charge in percentage (%)","nl":"Accuniveau in procenten (%)"},"chartType":"spline","decimals":2,"getable":true,"setable":false,"value":98,"lastUpdated":"2018-11-13T09:44:16.055Z","options":{}}},"driverUri":"homey:app:com.mi.flora","driverId":"flora"},{"__athom_api_type":"HomeyAPI.ManagerDevices.Device","id":"d05dfbd3-4d27-4cab-866a-e0ae0bcb15e5","name":"Bonsai","zone":{"id":"5204dc44-8e9c-49e7-aed8-9d5c93330126","name":"Tuin","icon":"garden","index":4,"parent":"9919ee1e-ffbc-480b-bc4b-77fb047e9e68"},"data":{"id":"c47c8d66087e","uuid":"c47c8d66087e","address":"c47c8d66087e","version":"v2.0.11"},"icon":"/app/com.mi.flora/drivers/flora/assets/icon.svg","settings":{"firmware_version":"3.1.9","last_updated":"2018-11-13T06:40:52.327Z","measure_temperature_min":15,"measure_temperature_max":32,"measure_luminance_min":2700,"measure_luminance_max":5400,"flora_measure_fertility_min":350,"flora_measure_fertility_max":1000,"flora_measure_moisture_min":15,"flora_measure_moisture_max":40,"uuid":"c47c8d66087e"},"class":"sensor","capabilities":["measure_temperature","measure_luminance","flora_measure_fertility","flora_measure_moisture","measure_battery"],"flags":[],"mobile":{"components":[{"id":"icon"},{"id":"battery","capabilities":["measure_battery"]},{"id":"sensor","capabilities":["measure_temperature","measure_luminance","flora_measure_fertility","flora_measure_moisture"],"options":{"icons":{"measure_temperature":"/assets/temperature.svg","measure_luminance":"/assets/luminance.svg","flora_measure_fertility":"/assets/nutritions.svg","flora_measure_moisture":"/assets/moisture.svg"}}}]},"order":31,"online":true,"available":true,"capabilitiesObj":{"measure_temperature":{"uri":"homey:manager:devices","id":"measure_temperature","type":"number","desc":{"en":"Temperature","nl":"Temperatuur"},"title":{"en":"Temperature","nl":"Temperatuur"},"units":{"en":"°C"},"decimals":2,"chartType":"spline","getable":true,"setable":false,"value":16.8,"lastUpdated":"2018-11-13T09:24:20.860Z","options":{}},"measure_luminance":{"uri":"homey:manager:devices","id":"measure_luminance","type":"number","title":{"en":"Luminance","nl":"Helderheid"},"units":{"en":"lx"},"desc":{"en":"Luminance in Lux (lx)","nl":"Helderheid in Lux (lx)"},"chartType":"spline","decimals":2,"getable":true,"setable":false,"value":151,"lastUpdated":"2018-11-13T09:24:20.861Z","options":{}},"flora_measure_fertility":{"uri":"homey:app:com.mi.flora","id":"flora_measure_fertility","type":"number","title":{"en":"Conductivity","nl":"Geleidingsvermogen"},"getable":true,"setable":false,"units":{"en":"µS/cm","nl":"µS/cm"},"min":0,"max":5000,"step":1,"value":179,"lastUpdated":"2018-11-13T09:24:20.942Z","options":{}},"flora_measure_moisture":{"uri":"homey:app:com.mi.flora","id":"flora_measure_moisture","type":"number","title":{"en":"Moisture","nl":"Vochtigheid"},"getable":true,"setable":false,"units":{"en":"%","nl":"%"},"min":0,"max":100,"step":1,"value":13,"lastUpdated":"2018-11-13T09:24:20.942Z","options":{}},"measure_battery":{"uri":"homey:manager:devices","id":"measure_battery","type":"number","title":{"en":"Battery","nl":"Accuniveau"},"units":{"en":"%"},"min":0,"max":100,"desc":{"en":"Battery charge in percentage (%)","nl":"Accuniveau in procenten (%)"},"chartType":"spline","decimals":2,"getable":true,"setable":false,"value":94,"lastUpdated":"2018-11-13T09:24:20.942Z","options":{}}},"driverUri":"homey:app:com.mi.flora","driverId":"flora"},{"__athom_api_type":"HomeyAPI.ManagerDevices.Device","id":"de9d1791-d674-42d6-8fa9-11387e9eaf40","name":"Pilea","zone":{"id":"5204dc44-8e9c-49e7-aed8-9d5c93330126","name":"Tuin","icon":"garden","index":4,"parent":"9919ee1e-ffbc-480b-bc4b-77fb047e9e68"},"data":{"id":"c47c8d6607fd","uuid":"c47c8d6607fd","address":"c47c8d6607fd","version":"v2.0.11"},"icon":"/app/com.mi.flora/drivers/flora/assets/icon.svg","settings":{"firmware_version":"3.1.9","last_updated":"2018-11-13T09:45:18.392Z","measure_temperature_min":8,"measure_temperature_max":32,"measure_luminance_min":600,"measure_luminance_max":2000,"flora_measure_fertility_min":350,"flora_measure_fertility_max":1000,"flora_measure_moisture_min":15,"flora_measure_moisture_max":60,"uuid":"c47c8d6607fd"},"class":"sensor","capabilities":["measure_temperature","measure_luminance","flora_measure_fertility","flora_measure_moisture","measure_battery"],"flags":[],"mobile":{"components":[{"id":"icon"},{"id":"battery","capabilities":["measure_battery"]},{"id":"sensor","capabilities":["measure_temperature","measure_luminance","flora_measure_fertility","flora_measure_moisture"],"options":{"icons":{"measure_temperature":"/assets/temperature.svg","measure_luminance":"/assets/luminance.svg","flora_measure_fertility":"/assets/nutritions.svg","flora_measure_moisture":"/assets/moisture.svg"}}}]},"order":32,"online":true,"available":true,"capabilitiesObj":{"measure_temperature":{"uri":"homey:manager:devices","id":"measure_temperature","type":"number","desc":{"en":"Temperature","nl":"Temperatuur"},"title":{"en":"Temperature","nl":"Temperatuur"},"units":{"en":"°C"},"decimals":2,"chartType":"spline","getable":true,"setable":false,"value":17.4,"lastUpdated":"2018-11-13T09:45:18.152Z","options":{}},"measure_luminance":{"uri":"homey:manager:devices","id":"measure_luminance","type":"number","title":{"en":"Luminance","nl":"Helderheid"},"units":{"en":"lx"},"desc":{"en":"Luminance in Lux (lx)","nl":"Helderheid in Lux (lx)"},"chartType":"spline","decimals":2,"getable":true,"setable":false,"value":458,"lastUpdated":"2018-11-13T09:45:18.183Z","options":{}},"flora_measure_fertility":{"uri":"homey:app:com.mi.flora","id":"flora_measure_fertility","type":"number","title":{"en":"Conductivity","nl":"Geleidingsvermogen"},"getable":true,"setable":false,"units":{"en":"µS/cm","nl":"µS/cm"},"min":0,"max":5000,"step":1,"value":2099,"lastUpdated":"2018-11-13T09:45:18.221Z","options":{}},"flora_measure_moisture":{"uri":"homey:app:com.mi.flora","id":"flora_measure_moisture","type":"number","title":{"en":"Moisture","nl":"Vochtigheid"},"getable":true,"setable":false,"units":{"en":"%","nl":"%"},"min":0,"max":100,"step":1,"value":39,"lastUpdated":"2018-11-13T09:45:18.250Z","options":{}},"measure_battery":{"uri":"homey:manager:devices","id":"measure_battery","type":"number","title":{"en":"Battery","nl":"Accuniveau"},"units":{"en":"%"},"min":0,"max":100,"desc":{"en":"Battery charge in percentage (%)","nl":"Accuniveau in procenten (%)"},"chartType":"spline","decimals":2,"getable":true,"setable":false,"value":99,"lastUpdated":"2018-11-13T09:45:18.397Z","options":{}}},"driverUri":"homey:app:com.mi.flora","driverId":"flora"},{"__athom_api_type":"HomeyAPI.ManagerDevices.Device","id":"05dd7a52-b408-4905-b9ec-19a172c126b6","name":"Ceropegia","zone":{"id":"5204dc44-8e9c-49e7-aed8-9d5c93330126","name":"Tuin","icon":"garden","index":4,"parent":"9919ee1e-ffbc-480b-bc4b-77fb047e9e68"},"data":{"id":"c47c8d660ac9","uuid":"c47c8d660ac9","address":"c47c8d660ac9","version":"v2.0.11"},"icon":"/app/com.mi.flora/drivers/flora/assets/icon.svg","settings":{"firmware_version":"3.1.9","last_updated":"2018-11-13T09:45:28.679Z","measure_temperature_min":8,"measure_temperature_max":32,"measure_luminance_min":2500,"measure_luminance_max":35000,"flora_measure_fertility_min":350,"flora_measure_fertility_max":1000,"flora_measure_moisture_min":15,"flora_measure_moisture_max":40,"uuid":"c47c8d660ac9"},"class":"sensor","capabilities":["measure_temperature","measure_luminance","flora_measure_fertility","flora_measure_moisture","measure_battery"],"flags":[],"mobile":{"components":[{"id":"icon"},{"id":"battery","capabilities":["measure_battery"]},{"id":"sensor","capabilities":["measure_temperature","measure_luminance","flora_measure_fertility","flora_measure_moisture"],"options":{"icons":{"measure_temperature":"/assets/temperature.svg","measure_luminance":"/assets/luminance.svg","flora_measure_fertility":"/assets/nutritions.svg","flora_measure_moisture":"/assets/moisture.svg"}}}]},"order":33,"online":true,"available":true,"capabilitiesObj":{"measure_temperature":{"uri":"homey:manager:devices","id":"measure_temperature","type":"number","desc":{"en":"Temperature","nl":"Temperatuur"},"title":{"en":"Temperature","nl":"Temperatuur"},"units":{"en":"°C"},"decimals":2,"chartType":"spline","getable":true,"setable":false,"value":17,"lastUpdated":"2018-11-13T09:45:28.483Z","options":{}},"measure_luminance":{"uri":"homey:manager:devices","id":"measure_luminance","type":"number","title":{"en":"Luminance","nl":"Helderheid"},"units":{"en":"lx"},"desc":{"en":"Luminance in Lux (lx)","nl":"Helderheid in Lux (lx)"},"chartType":"spline","decimals":2,"getable":true,"setable":false,"value":389,"lastUpdated":"2018-11-13T09:45:28.495Z","options":{}},"flora_measure_fertility":{"uri":"homey:app:com.mi.flora","id":"flora_measure_fertility","type":"number","title":{"en":"Conductivity","nl":"Geleidingsvermogen"},"getable":true,"setable":false,"units":{"en":"µS/cm","nl":"µS/cm"},"min":0,"max":5000,"step":1,"value":372,"lastUpdated":"2018-11-13T09:45:28.510Z","options":{}},"flora_measure_moisture":{"uri":"homey:app:com.mi.flora","id":"flora_measure_moisture","type":"number","title":{"en":"Moisture","nl":"Vochtigheid"},"getable":true,"setable":false,"units":{"en":"%","nl":"%"},"min":0,"max":100,"step":1,"value":19,"lastUpdated":"2018-11-13T09:45:28.527Z","options":{}},"measure_battery":{"uri":"homey:manager:devices","id":"measure_battery","type":"number","title":{"en":"Battery","nl":"Accuniveau"},"units":{"en":"%"},"min":0,"max":100,"desc":{"en":"Battery charge in percentage (%)","nl":"Accuniveau in procenten (%)"},"chartType":"spline","decimals":2,"getable":true,"setable":false,"value":94,"lastUpdated":"2018-11-13T09:45:28.676Z","options":{}}},"driverUri":"homey:app:com.mi.flora","driverId":"flora"},{"__athom_api_type":"HomeyAPI.ManagerDevices.Device","id":"b38fd68a-5f5f-4aaf-a7cc-b5881f30fb56","name":"Monstera","zone":{"id":"5204dc44-8e9c-49e7-aed8-9d5c93330126","name":"Tuin","icon":"garden","index":4,"parent":"9919ee1e-ffbc-480b-bc4b-77fb047e9e68"},"data":{"id":"c47c8d661988","uuid":"c47c8d661988","address":"c47c8d661988","version":"v2.0.11"},"icon":"/app/com.mi.flora/drivers/flora/assets/icon.svg","settings":{"firmware_version":"3.1.9","last_updated":"2018-11-13T09:46:07.382Z","measure_temperature_min":12,"measure_temperature_max":32,"measure_luminance_min":1000,"measure_luminance_max":3400,"flora_measure_fertility_min":350,"flora_measure_fertility_max":1000,"flora_measure_moisture_min":15,"flora_measure_moisture_max":30,"uuid":"c47c8d661988"},"class":"sensor","capabilities":["measure_temperature","measure_luminance","flora_measure_fertility","flora_measure_moisture","measure_battery"],"flags":[],"mobile":{"components":[{"id":"icon"},{"id":"battery","capabilities":["measure_battery"]},{"id":"sensor","capabilities":["measure_temperature","measure_luminance","flora_measure_fertility","flora_measure_moisture"],"options":{"icons":{"measure_temperature":"/assets/temperature.svg","measure_luminance":"/assets/luminance.svg","flora_measure_fertility":"/assets/nutritions.svg","flora_measure_moisture":"/assets/moisture.svg"}}}]},"order":34,"online":true,"available":true,"capabilitiesObj":{"measure_temperature":{"uri":"homey:manager:devices","id":"measure_temperature","type":"number","desc":{"en":"Temperature","nl":"Temperatuur"},"title":{"en":"Temperature","nl":"Temperatuur"},"units":{"en":"°C"},"decimals":2,"chartType":"spline","getable":true,"setable":false,"value":17.2,"lastUpdated":"2018-11-13T09:46:07.164Z","options":{}},"measure_luminance":{"uri":"homey:manager:devices","id":"measure_luminance","type":"number","title":{"en":"Luminance","nl":"Helderheid"},"units":{"en":"lx"},"desc":{"en":"Luminance in Lux (lx)","nl":"Helderheid in Lux (lx)"},"chartType":"spline","decimals":2,"getable":true,"setable":false,"value":238,"lastUpdated":"2018-11-13T09:46:07.200Z","options":{}},"flora_measure_fertility":{"uri":"homey:app:com.mi.flora","id":"flora_measure_fertility","type":"number","title":{"en":"Conductivity","nl":"Geleidingsvermogen"},"getable":true,"setable":false,"units":{"en":"µS/cm","nl":"µS/cm"},"min":0,"max":5000,"step":1,"value":1462,"lastUpdated":"2018-11-13T09:46:07.237Z","options":{}},"flora_measure_moisture":{"uri":"homey:app:com.mi.flora","id":"flora_measure_moisture","type":"number","title":{"en":"Moisture","nl":"Vochtigheid"},"getable":true,"setable":false,"units":{"en":"%","nl":"%"},"min":0,"max":100,"step":1,"value":66,"lastUpdated":"2018-11-13T09:46:07.356Z","options":{}},"measure_battery":{"uri":"homey:manager:devices","id":"measure_battery","type":"number","title":{"en":"Battery","nl":"Accuniveau"},"units":{"en":"%"},"min":0,"max":100,"desc":{"en":"Battery charge in percentage (%)","nl":"Accuniveau in procenten (%)"},"chartType":"spline","decimals":2,"getable":true,"setable":false,"value":97,"lastUpdated":"2018-11-13T09:46:07.378Z","options":{}}},"driverUri":"homey:app:com.mi.flora","driverId":"flora"},{"__athom_api_type":"HomeyAPI.ManagerDevices.Device","id":"fa374fb3-a3bc-4eaf-bdc6-8bae331da4f6","name":"Alocasia","zone":{"id":"5204dc44-8e9c-49e7-aed8-9d5c93330126","name":"Tuin","icon":"garden","index":4,"parent":"9919ee1e-ffbc-480b-bc4b-77fb047e9e68"},"data":{"id":"c47c8d66088c","uuid":"c47c8d66088c","address":"c47c8d66088c","version":"v2.0.11"},"icon":"/app/com.mi.flora/drivers/flora/assets/icon.svg","settings":{"firmware_version":"3.1.9","last_updated":"2018-11-13T09:46:49.034Z","measure_temperature_min":10,"measure_temperature_max":32,"measure_luminance_min":1000,"measure_luminance_max":3500,"flora_measure_fertility_min":350,"flora_measure_fertility_max":1000,"flora_measure_moisture_min":15,"flora_measure_moisture_max":30,"uuid":"c47c8d66088c"},"class":"sensor","capabilities":["measure_temperature","measure_luminance","flora_measure_fertility","flora_measure_moisture","measure_battery"],"flags":[],"mobile":{"components":[{"id":"icon"},{"id":"battery","capabilities":["measure_battery"]},{"id":"sensor","capabilities":["measure_temperature","measure_luminance","flora_measure_fertility","flora_measure_moisture"],"options":{"icons":{"measure_temperature":"/assets/temperature.svg","measure_luminance":"/assets/luminance.svg","flora_measure_fertility":"/assets/nutritions.svg","flora_measure_moisture":"/assets/moisture.svg"}}}]},"order":35,"online":true,"available":true,"capabilitiesObj":{"measure_temperature":{"uri":"homey:manager:devices","id":"measure_temperature","type":"number","desc":{"en":"Temperature","nl":"Temperatuur"},"title":{"en":"Temperature","nl":"Temperatuur"},"units":{"en":"°C"},"decimals":2,"chartType":"spline","getable":true,"setable":false,"value":17.3,"lastUpdated":"2018-11-13T09:46:48.763Z","options":{}},"measure_luminance":{"uri":"homey:manager:devices","id":"measure_luminance","type":"number","title":{"en":"Luminance","nl":"Helderheid"},"units":{"en":"lx"},"desc":{"en":"Luminance in Lux (lx)","nl":"Helderheid in Lux (lx)"},"chartType":"spline","decimals":2,"getable":true,"setable":false,"value":1057,"lastUpdated":"2018-11-13T09:46:48.878Z","options":{}},"flora_measure_fertility":{"uri":"homey:app:com.mi.flora","id":"flora_measure_fertility","type":"number","title":{"en":"Conductivity","nl":"Geleidingsvermogen"},"getable":true,"setable":false,"units":{"en":"µS/cm","nl":"µS/cm"},"min":0,"max":5000,"step":1,"value":106,"lastUpdated":"2018-11-13T09:46:48.912Z","options":{}},"flora_measure_moisture":{"uri":"homey:app:com.mi.flora","id":"flora_measure_moisture","type":"number","title":{"en":"Moisture","nl":"Vochtigheid"},"getable":true,"setable":false,"units":{"en":"%","nl":"%"},"min":0,"max":100,"step":1,"value":21,"lastUpdated":"2018-11-13T09:46:48.939Z","options":{}},"measure_battery":{"uri":"homey:manager:devices","id":"measure_battery","type":"number","title":{"en":"Battery","nl":"Accuniveau"},"units":{"en":"%"},"min":0,"max":100,"desc":{"en":"Battery charge in percentage (%)","nl":"Accuniveau in procenten (%)"},"chartType":"spline","decimals":2,"getable":true,"setable":false,"value":93,"lastUpdated":"2018-11-13T09:46:49.082Z","options":{}}},"driverUri":"homey:app:com.mi.flora","driverId":"flora"},{"__athom_api_type":"HomeyAPI.ManagerDevices.Device","id":"b150f707-c308-48f8-ab97-37ab99f94f70","name":"Philodendron erubescens","zone":{"id":"5204dc44-8e9c-49e7-aed8-9d5c93330126","name":"Tuin","icon":"garden","index":4,"parent":"9919ee1e-ffbc-480b-bc4b-77fb047e9e68"},"data":{"id":"c47c8d67563f","uuid":"c47c8d67563f","address":"c47c8d67563f","version":"v2.0.12"},"icon":"/app/com.mi.flora/drivers/flora/assets/icon.svg","settings":{"firmware_version":"2.7.0","last_updated":"2018-11-13T09:46:59.335Z","measure_temperature_min":8,"measure_temperature_max":32,"measure_luminance_min":600,"measure_luminance_max":15000,"flora_measure_fertility_min":350,"flora_measure_fertility_max":2000,"flora_measure_moisture_min":15,"flora_measure_moisture_max":60,"uuid":"c47c8d67563f"},"class":"sensor","capabilities":["measure_temperature","measure_luminance","flora_measure_fertility","flora_measure_moisture","measure_battery"],"flags":[],"mobile":{"components":[{"id":"icon"},{"id":"battery","capabilities":["measure_battery"]},{"id":"sensor","capabilities":["measure_temperature","measure_luminance","flora_measure_fertility","flora_measure_moisture"],"options":{"icons":{"measure_temperature":"/assets/temperature.svg","measure_luminance":"/assets/luminance.svg","flora_measure_fertility":"/assets/nutritions.svg","flora_measure_moisture":"/assets/moisture.svg"}}}]},"order":36,"online":true,"available":true,"capabilitiesObj":{"measure_temperature":{"uri":"homey:manager:devices","id":"measure_temperature","type":"number","desc":{"en":"Temperature","nl":"Temperatuur"},"title":{"en":"Temperature","nl":"Temperatuur"},"units":{"en":"°C"},"decimals":2,"chartType":"spline","getable":true,"setable":false,"value":16.9,"lastUpdated":"2018-11-13T09:46:59.073Z","options":{}},"measure_luminance":{"uri":"homey:manager:devices","id":"measure_luminance","type":"number","title":{"en":"Luminance","nl":"Helderheid"},"units":{"en":"lx"},"desc":{"en":"Luminance in Lux (lx)","nl":"Helderheid in Lux (lx)"},"chartType":"spline","decimals":2,"getable":true,"setable":false,"value":131,"lastUpdated":"2018-11-13T09:46:59.103Z","options":{}},"flora_measure_fertility":{"uri":"homey:app:com.mi.flora","id":"flora_measure_fertility","type":"number","title":{"en":"Conductivity","nl":"Geleidingsvermogen"},"getable":true,"setable":false,"units":{"en":"µS/cm","nl":"µS/cm"},"min":0,"max":5000,"step":1,"value":6,"lastUpdated":"2018-11-13T09:46:59.136Z","options":{}},"flora_measure_moisture":{"uri":"homey:app:com.mi.flora","id":"flora_measure_moisture","type":"number","title":{"en":"Moisture","nl":"Vochtigheid"},"getable":true,"setable":false,"units":{"en":"%","nl":"%"},"min":0,"max":100,"step":1,"value":14,"lastUpdated":"2018-11-13T09:46:59.177Z","options":{}},"measure_battery":{"uri":"homey:manager:devices","id":"measure_battery","type":"number","title":{"en":"Battery","nl":"Accuniveau"},"units":{"en":"%"},"min":0,"max":100,"desc":{"en":"Battery charge in percentage (%)","nl":"Accuniveau in procenten (%)"},"chartType":"spline","decimals":2,"getable":true,"setable":false,"value":94,"lastUpdated":"2018-11-13T09:46:59.331Z","options":{}}},"driverUri":"homey:app:com.mi.flora","driverId":"flora"},{"__athom_api_type":"HomeyAPI.ManagerDevices.Device","id":"b9ff319e-6ee5-4e1d-9160-2e68daf4f807","name":"Monstera XXL","zone":{"id":"5204dc44-8e9c-49e7-aed8-9d5c93330126","name":"Tuin","icon":"garden","index":4,"parent":"9919ee1e-ffbc-480b-bc4b-77fb047e9e68"},"data":{"id":"c47c8d675618","uuid":"c47c8d675618","address":"c47c8d675618","version":"v2.0.12"},"icon":"/app/com.mi.flora/drivers/flora/assets/icon.svg","settings":{"firmware_version":"2.7.0","last_updated":"2018-11-13T09:47:45.845Z","measure_temperature_min":15,"measure_temperature_max":60,"measure_luminance_min":600,"measure_luminance_max":1500,"flora_measure_fertility_min":300,"flora_measure_fertility_max":2000,"flora_measure_moisture_min":15,"flora_measure_moisture_max":60,"uuid":"c47c8d675618"},"class":"sensor","capabilities":["measure_temperature","measure_luminance","flora_measure_fertility","flora_measure_moisture","measure_battery"],"flags":[],"mobile":{"components":[{"id":"icon"},{"id":"battery","capabilities":["measure_battery"]},{"id":"sensor","capabilities":["measure_temperature","measure_luminance","flora_measure_fertility","flora_measure_moisture"],"options":{"icons":{"measure_temperature":"/assets/temperature.svg","measure_luminance":"/assets/luminance.svg","flora_measure_fertility":"/assets/nutritions.svg","flora_measure_moisture":"/assets/moisture.svg"}}}]},"order":37,"online":true,"available":true,"capabilitiesObj":{"measure_temperature":{"uri":"homey:manager:devices","id":"measure_temperature","type":"number","desc":{"en":"Temperature","nl":"Temperatuur"},"title":{"en":"Temperature","nl":"Temperatuur"},"units":{"en":"°C"},"decimals":2,"chartType":"spline","getable":true,"setable":false,"value":17.2,"lastUpdated":"2018-11-13T09:47:45.383Z","options":{}},"measure_luminance":{"uri":"homey:manager:devices","id":"measure_luminance","type":"number","title":{"en":"Luminance","nl":"Helderheid"},"units":{"en":"lx"},"desc":{"en":"Luminance in Lux (lx)","nl":"Helderheid in Lux (lx)"},"chartType":"spline","decimals":2,"getable":true,"setable":false,"value":117,"lastUpdated":"2018-11-13T09:47:45.411Z","options":{}},"flora_measure_fertility":{"uri":"homey:app:com.mi.flora","id":"flora_measure_fertility","type":"number","title":{"en":"Conductivity","nl":"Geleidingsvermogen"},"getable":true,"setable":false,"units":{"en":"µS/cm","nl":"µS/cm"},"min":0,"max":5000,"step":1,"value":0,"lastUpdated":"2018-11-13T09:47:45.634Z","options":{}},"flora_measure_moisture":{"uri":"homey:app:com.mi.flora","id":"flora_measure_moisture","type":"number","title":{"en":"Moisture","nl":"Vochtigheid"},"getable":true,"setable":false,"units":{"en":"%","nl":"%"},"min":0,"max":100,"step":1,"value":16,"lastUpdated":"2018-11-13T09:47:45.638Z","options":{}},"measure_battery":{"uri":"homey:manager:devices","id":"measure_battery","type":"number","title":{"en":"Battery","nl":"Accuniveau"},"units":{"en":"%"},"min":0,"max":100,"desc":{"en":"Battery charge in percentage (%)","nl":"Accuniveau in procenten (%)"},"chartType":"spline","decimals":2,"getable":true,"setable":false,"value":83,"lastUpdated":"2018-11-13T09:47:45.852Z","options":{}}},"driverUri":"homey:app:com.mi.flora","driverId":"flora"}]';

            /*
                Homey.users.getUserMe();

                Homey.devices.getDevices({online: true}).then((devices) => {
                    var floraDevices = Object.values(devices).filter(function (device) {
                        return device.driverId === 'flora';
                    });
                });
             */

            let floraDevices = JSON.parse(devicesJson);

            let html = '';
            floraDevices.forEach(function (floraDevice) {
                html = html + _generateFloraHtml(floraDevice);
            });

            document.getElementById('target').innerHTML = html;
        });

    </script>
    <title>Title</title>
</head>
<body>
<div id="target"></div>
</body>
</html>